\begin{Verbatim}[commandchars=\\\{\},codes={\catcode`\$=3\catcode`\^=7\catcode`\_=8}]
\PYG{k+kr}{val} \PYG{n+nv}{rec} \PYG{n}{is\PYGZus{}bound} \PYG{p}{=}
	\PYG{k+kr}{fn} \PYG{n}{s} \PYG{p}{=\PYGZgt{}} \PYG{k+kr}{fn} \PYG{n}{Var} \PYG{n}{v} \PYG{p}{=\PYGZgt{}} \PYG{n}{s} \PYG{p}{=} \PYG{n}{v}
			 \PYG{n}{|} \PYG{n}{Lambda} \PYG{p}{(}\PYG{n}{v}\PYG{p}{,} \PYG{n}{e}\PYG{p}{)} \PYG{p}{=\PYGZgt{}} \PYG{k+kr}{if} \PYG{p}{(}\PYG{n}{s} \PYG{p}{=} \PYG{n}{v}\PYG{p}{)} \PYG{k+kr}{then}
									\PYG{n}{true}
								\PYG{k+kr}{else}
									\PYG{n}{is\PYGZus{}bound} \PYG{n}{s} \PYG{n}{e}
			 \PYG{n}{|} \PYG{n}{Apply} \PYG{p}{(}\PYG{n}{e1}\PYG{p}{,} \PYG{n}{e2}\PYG{p}{)} \PYG{p}{=\PYGZgt{}} \PYG{p}{(}\PYG{n}{is\PYGZus{}bound} \PYG{n}{s} \PYG{n}{e1}\PYG{p}{)} \PYG{k+kr}{orelse} \PYG{p}{(}\PYG{n}{is\PYGZus{}bound} \PYG{n}{s} \PYG{n}{e2}\PYG{p}{);}
\end{Verbatim}
